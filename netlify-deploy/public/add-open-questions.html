<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dodawanie Zada≈Ñ Otwartych - QuizMaster</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body class="text-white p-4">
    <div class="max-w-6xl mx-auto">
        <div class="glass rounded-lg p-6 mb-6">
            <h1 class="text-3xl font-bold mb-2">üìù Dodawanie Zada≈Ñ Otwartych</h1>
            <p class="text-gray-200">Prosty spos√≥b na tworzenie zada≈Ñ z pe≈ÇnƒÖ funkcjonalno≈õciƒÖ oceniania AI</p>
        </div>

        <div class="grid md:grid-cols-2 gap-6">
            <!-- Formularz dodawania -->
            <div class="glass rounded-lg p-6">
                <h2 class="text-xl font-semibold mb-4">Nowe zadanie</h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Nazwa quizu/testu</label>
                        <input type="text" id="quizName" placeholder="np. Test z matematyki - Funkcje" 
                               class="w-full px-4 py-2 bg-white/20 rounded-lg text-white placeholder-gray-300">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Przedmiot</label>
                            <select id="subject" class="w-full px-4 py-2 bg-white/20 rounded-lg text-white">
                                <option value="matematyka">Matematyka</option>
                                <option value="fizyka">Fizyka</option>
                                <option value="chemia">Chemia</option>
                                <option value="biologia">Biologia</option>
                                <option value="informatyka">Informatyka</option>
                                <option value="polski">Jƒôzyk polski</option>
                                <option value="historia">Historia</option>
                                <option value="geografia">Geografia</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Klasa</label>
                            <select id="classLevel" class="w-full px-4 py-2 bg-white/20 rounded-lg text-white">
                                <option value="6a">6a</option>
                                <option value="6b">6b</option>
                                <option value="7a">7a</option>
                                <option value="7b">7b</option>
                                <option value="8a">8a</option>
                                <option value="8b">8b</option>
                            </select>
                        </div>
                    </div>

                    <hr class="border-white/20 my-4">

                    <div>
                        <label class="block text-sm font-medium mb-2">Tre≈õƒá zadania</label>
                        <textarea id="questionText" rows="4" 
                                  placeholder="Wpisz tre≈õƒá zadania..." 
                                  class="w-full px-4 py-2 bg-white/20 rounded-lg text-white placeholder-gray-300"></textarea>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Liczba punkt√≥w</label>
                        <input type="number" id="points" value="10" min="1" max="100"
                               class="w-full px-4 py-2 bg-white/20 rounded-lg text-white">
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Wzorcowa odpowied≈∫</label>
                        <textarea id="modelAnswer" rows="3" 
                                  placeholder="Podaj wzorcowƒÖ odpowied≈∫..." 
                                  class="w-full px-4 py-2 bg-white/20 rounded-lg text-white placeholder-gray-300"></textarea>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Kryteria oceniania (po jednym w linii)</label>
                        <textarea id="criteria" rows="4" 
                                  placeholder="- Zastosowanie odpowiedniego wzoru&#10;- Poprawne obliczenia&#10;- W≈Ça≈õciwa jednostka&#10;- Czytelny zapis" 
                                  class="w-full px-4 py-2 bg-white/20 rounded-lg text-white placeholder-gray-300"></textarea>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Wskaz√≥wki dla AI (opcjonalne)</label>
                        <textarea id="aiHints" rows="2" 
                                  placeholder="np. Zwr√≥ƒá uwagƒô na jednostki, zaokrƒÖglij do 2 miejsc po przecinku" 
                                  class="w-full px-4 py-2 bg-white/20 rounded-lg text-white placeholder-gray-300"></textarea>
                    </div>

                    <div class="flex gap-3">
                        <button onclick="addQuestion()" 
                                class="flex-1 bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg font-semibold transition">
                            <i class="fas fa-plus mr-2"></i>Dodaj zadanie
                        </button>
                        <button onclick="clearForm()" 
                                class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded-lg font-semibold transition">
                            <i class="fas fa-eraser mr-2"></i>Wyczy≈õƒá
                        </button>
                    </div>
                </div>
            </div>

            <!-- PodglƒÖd i lista zada≈Ñ -->
            <div class="glass rounded-lg p-6">
                <h2 class="text-xl font-semibold mb-4">PodglƒÖd zada≈Ñ</h2>
                
                <div id="questionsList" class="space-y-4 max-h-96 overflow-y-auto">
                    <p class="text-gray-300 text-center py-8">Brak zada≈Ñ. Dodaj pierwsze zadanie.</p>
                </div>

                <div class="mt-6 space-y-3">
                    <button onclick="saveQuiz()" 
                            class="w-full bg-purple-600 hover:bg-purple-700 px-4 py-3 rounded-lg font-semibold transition disabled:opacity-50"
                            id="saveButton" disabled>
                        <i class="fas fa-save mr-2"></i>Zapisz quiz
                    </button>
                    
                    <button onclick="exportQuestions()" 
                            class="w-full bg-blue-600 hover:bg-blue-700 px-4 py-3 rounded-lg font-semibold transition disabled:opacity-50"
                            id="exportButton" disabled>
                        <i class="fas fa-download mr-2"></i>Eksportuj jako JSON
                    </button>

                    <button onclick="loadExample()" 
                            class="w-full bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded-lg font-semibold transition">
                        <i class="fas fa-lightbulb mr-2"></i>Za≈Çaduj przyk≈Çad
                    </button>
                </div>
            </div>
        </div>

        <!-- Instrukcja -->
        <div class="glass rounded-lg p-6 mt-6">
            <h2 class="text-xl font-semibold mb-4">üìñ Jak dodawaƒá zadania otwarte?</h2>
            <div class="grid md:grid-cols-2 gap-6 text-sm">
                <div>
                    <h3 class="font-semibold mb-2 text-yellow-300">1. Podstawowe informacje</h3>
                    <ul class="space-y-1 text-gray-200">
                        <li>‚Ä¢ <strong>Nazwa quizu</strong> - tytu≈Ç ca≈Çego testu</li>
                        <li>‚Ä¢ <strong>Przedmiot i klasa</strong> - do kategoryzacji</li>
                        <li>‚Ä¢ <strong>Tre≈õƒá zadania</strong> - dok≈Çadne polecenie dla ucznia</li>
                        <li>‚Ä¢ <strong>Punkty</strong> - maksymalna liczba punkt√≥w</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-semibold mb-2 text-yellow-300">2. Ocenianie przez AI</h3>
                    <ul class="space-y-1 text-gray-200">
                        <li>‚Ä¢ <strong>Wzorcowa odpowied≈∫</strong> - przyk≈Çad poprawnego rozwiƒÖzania</li>
                        <li>‚Ä¢ <strong>Kryteria</strong> - co AI ma sprawdzaƒá (ka≈ºde w nowej linii)</li>
                        <li>‚Ä¢ <strong>Wskaz√≥wki</strong> - dodatkowe instrukcje dla AI</li>
                        <li>‚Ä¢ AI automatycznie oceni odpowiedzi uczni√≥w</li>
                    </ul>
                </div>
            </div>
            
            <div class="mt-4 p-4 bg-white/10 rounded-lg">
                <h3 class="font-semibold mb-2 text-green-300">üí° Wskaz√≥wki:</h3>
                <ul class="text-sm space-y-1 text-gray-200">
                    <li>‚úì Pisz jasne, jednoznaczne polecenia</li>
                    <li>‚úì Podaj wszystkie wa≈ºne kryteria oceniania</li>
                    <li>‚úì Dla zada≈Ñ matematycznych uwzglƒôdnij r√≥≈ºne metody rozwiƒÖzania</li>
                    <li>‚úì Okre≈õl dok≈Çadno≈õƒá oblicze≈Ñ (np. "do 2 miejsc po przecinku")</li>
                    <li>‚úì Mo≈ºesz dodaƒá wiele zada≈Ñ do jednego quizu</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        let questions = [];
        let currentQuizId = null;

        function addQuestion() {
            const questionText = document.getElementById('questionText').value.trim();
            const points = parseInt(document.getElementById('points').value);
            const modelAnswer = document.getElementById('modelAnswer').value.trim();
            const criteria = document.getElementById('criteria').value.trim();
            
            if (!questionText || !modelAnswer || !criteria) {
                alert('Wype≈Çnij wszystkie wymagane pola!');
                return;
            }

            const question = {
                id: `q_${Date.now()}`,
                tresc: questionText,
                typ: 'otwarte',
                punkty: points,
                odpowiedzWzorcowa: modelAnswer,
                kryteriaOceniania: criteria.split('\n').filter(c => c.trim()),
                wskazowkiAI: document.getElementById('aiHints').value.trim() || null
            };

            questions.push(question);
            updateQuestionsList();
            clearQuestionForm();
        }

        function updateQuestionsList() {
            const list = document.getElementById('questionsList');
            const saveBtn = document.getElementById('saveButton');
            const exportBtn = document.getElementById('exportButton');

            if (questions.length === 0) {
                list.innerHTML = '<p class="text-gray-300 text-center py-8">Brak zada≈Ñ. Dodaj pierwsze zadanie.</p>';
                saveBtn.disabled = true;
                exportBtn.disabled = true;
                return;
            }

            saveBtn.disabled = false;
            exportBtn.disabled = false;

            list.innerHTML = questions.map((q, index) => `
                <div class="bg-white/10 rounded-lg p-4">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-semibold">Zadanie ${index + 1} (${q.punkty} pkt)</h4>
                        <button onclick="removeQuestion(${index})" 
                                class="text-red-400 hover:text-red-300">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <p class="text-sm mb-2">${q.tresc}</p>
                    <div class="text-xs text-gray-300">
                        <p><strong>Wzorcowa odpowied≈∫:</strong> ${q.odpowiedzWzorcowa}</p>
                        <p><strong>Kryteria:</strong> ${q.kryteriaOceniania.join(', ')}</p>
                        ${q.wskazowkiAI ? `<p><strong>Wskaz√≥wki AI:</strong> ${q.wskazowkiAI}</p>` : ''}
                    </div>
                </div>
            `).join('');
        }

        function removeQuestion(index) {
            questions.splice(index, 1);
            updateQuestionsList();
        }

        function clearQuestionForm() {
            document.getElementById('questionText').value = '';
            document.getElementById('modelAnswer').value = '';
            document.getElementById('criteria').value = '';
            document.getElementById('aiHints').value = '';
        }

        function clearForm() {
            clearQuestionForm();
            document.getElementById('quizName').value = '';
            questions = [];
            updateQuestionsList();
        }

        function saveQuiz() {
            const quizName = document.getElementById('quizName').value.trim();
            if (!quizName) {
                alert('Podaj nazwƒô quizu!');
                return;
            }

            const quiz = {
                id: `quiz_${Date.now()}`,
                nazwa: quizName,
                przedmiot: document.getElementById('subject').value,
                klasa: document.getElementById('classLevel').value,
                nauczyciel: 'teacher_paulina',
                czasTrwania: Math.max(questions.length * 5, 20),
                punkty: questions.reduce((sum, q) => sum + q.punkty, 0),
                aktywny: true,
                dataUtworzenia: new Date().toISOString(),
                pytania: questions
            };

            // Zapisz do localStorage
            const quizzes = JSON.parse(localStorage.getItem('quizzes') || '[]');
            quizzes.push(quiz);
            localStorage.setItem('quizzes', JSON.stringify(quizzes));

            alert(`‚úÖ Quiz "${quizName}" zosta≈Ç zapisany!\n\nZawiera ${questions.length} zada≈Ñ za ≈ÇƒÖcznie ${quiz.punkty} punkt√≥w.`);
            
            // Wyczy≈õƒá formularz
            clearForm();
        }

        function exportQuestions() {
            const quizName = document.getElementById('quizName').value.trim() || 'quiz_export';
            const data = {
                nazwa: quizName,
                przedmiot: document.getElementById('subject').value,
                klasa: document.getElementById('classLevel').value,
                pytania: questions,
                exportDate: new Date().toISOString()
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${quizName.replace(/\s+/g, '_')}_${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function loadExample() {
            document.getElementById('quizName').value = 'Test z matematyki - R√≥wnania kwadratowe';
            document.getElementById('subject').value = 'matematyka';
            document.getElementById('classLevel').value = '8a';
            
            // Przyk≈Çadowe zadanie 1
            document.getElementById('questionText').value = 'RozwiƒÖ≈º r√≥wnanie: 2x¬≤ - 5x - 3 = 0';
            document.getElementById('points').value = '12';
            document.getElementById('modelAnswer').value = 'x‚ÇÅ = 3, x‚ÇÇ = -0,5';
            document.getElementById('criteria').value = `- Zastosowanie wzoru na deltƒô lub rozk≈Çadu na czynniki
- Poprawne obliczenie delty: Œî = 25 + 24 = 49
- Obliczenie pierwiastk√≥w
- Podanie obu rozwiƒÖza≈Ñ
- Poprawno≈õƒá oblicze≈Ñ`;
            document.getElementById('aiHints').value = 'Akceptuj r√≥≈ºne metody rozwiƒÖzania. Zwr√≥ƒá uwagƒô na dok≈Çadno≈õƒá oblicze≈Ñ.';
            
            addQuestion();
            
            // Przyk≈Çadowe zadanie 2
            document.getElementById('questionText').value = 'Dla jakich warto≈õci parametru k r√≥wnanie x¬≤ + kx + 9 = 0 ma dok≈Çadnie jedno rozwiƒÖzanie?';
            document.getElementById('points').value = '15';
            document.getElementById('modelAnswer').value = 'k = 6 lub k = -6';
            document.getElementById('criteria').value = `- Warunek na jedno rozwiƒÖzanie: Œî = 0
- Obliczenie delty: Œî = k¬≤ - 36
- RozwiƒÖzanie r√≥wnania k¬≤ - 36 = 0
- Podanie obu warto≈õci parametru k
- Uzasadnienie odpowiedzi`;
            document.getElementById('aiHints').value = 'Sprawd≈∫ czy ucze≈Ñ rozumie, ≈ºe jedno rozwiƒÖzanie oznacza deltƒô r√≥wnƒÖ zero.';
            
            addQuestion();
        }
    </script>
</body>
</html>